{"openapi":"3.1.0","info":{"title":"Phase IV Todo AI Assistant","description":"Full-stack todo application with authentication and database persistence","version":"4.0.0"},"paths":{"/api/auth/signup":{"post":{"tags":["Authentication"],"summary":"Signup","description":"Register a new user account\n\n- **email**: Valid email address (unique)\n- **password**: Minimum 8 characters\n- **name**: Optional display name\n\nReturns JWT tokens and user profile","operationId":"signup_api_auth_signup_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SignupRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login":{"post":{"tags":["Authentication"],"summary":"Login","description":"Authenticate user and return JWT tokens\n\n- **email**: Registered email address\n- **password**: User password\n- **remember_me**: Keep session active (currently same expiration)\n\nReturns JWT tokens and user profile","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks":{"post":{"tags":["Tasks"],"summary":"Create Task","description":"Create a new task for the authenticated user\n\n- **title**: Task title (1-200 characters, required)\n- **description**: Optional task description\n- **due_date**: Optional due date\n- **priority**: Priority level (low, medium, high)\n- **category**: Task category (personal, work, study, health, shopping, other)\n\nReturns the created task with timestamps","operationId":"create_task_api_tasks_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Tasks"],"summary":"List Tasks","description":"Get all tasks for the authenticated user\n\n- **filter**: Optional filter by status (all, pending, completed)\n\nReturns tasks sorted by creation date (newest first) with statistics","operationId":"list_tasks_api_tasks_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"filter","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by status: all, pending, completed","title":"Filter"},"description":"Filter by status: all, pending, completed"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/{task_id}":{"get":{"tags":["Tasks"],"summary":"Get Task","description":"Get a single task by ID\n\nReturns 404 if task doesn't exist\nReturns 403 if task belongs to another user","operationId":"get_task_api_tasks__task_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Tasks"],"summary":"Update Task","description":"Update an existing task\n\n- **title**: New task title (optional)\n- **description**: New task description (optional)\n- **completed**: New completion status (optional)\n- **due_date**: New due date (optional)\n- **priority**: New priority level (optional)\n- **category**: New category (optional)\n\nReturns 404 if task doesn't exist\nReturns 403 if task belongs to another user","operationId":"update_task_api_tasks__task_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Tasks"],"summary":"Delete Task","description":"Delete a task\n\nReturns 204 No Content on success\nReturns 404 if task doesn't exist\nReturns 403 if task belongs to another user","operationId":"delete_task_api_tasks__task_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/{task_id}/complete":{"patch":{"tags":["Tasks"],"summary":"Toggle Task Completion","description":"Toggle task completion status (complete <-> incomplete)\n\nReturns 404 if task doesn't exist\nReturns 403 if task belongs to another user","operationId":"toggle_task_completion_api_tasks__task_id__complete_patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"integer","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/{user_id}/chat":{"post":{"tags":["Chat"],"summary":"Send Chat Message","description":"Send a chat message and get AI assistant response.\n\nThis endpoint processes user messages with the AI assistant, which can\ninvoke MCP tools to manage tasks. The conversation is stateful and\npersisted in the database.\n\nArgs:\n    user_id: User ID from path (must match authenticated user)\n    message_data: Message content with optional conversation_id\n    current_user: Authenticated user from JWT token\n    session: Database session\n\nReturns:\n    ChatResponse: Contains AI response, conversation_id, and tool_calls\n\nRaises:\n    HTTPException 401: Invalid or missing authentication\n    HTTPException 403: User ID mismatch (not authorized)\n    HTTPException 404: Conversation not found\n    HTTPException 500: Internal server error (AI processing failure)\n\nExample:\n    POST /api/user123/chat\n    {\n        \"message\": \"Add a task to buy groceries\"\n    }\n\n    Response:\n    {\n        \"conversation_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"response\": \"I've added 'Buy groceries' to your tasks.\",\n        \"tool_calls\": [\n            {\n                \"tool\": \"add_task\",\n                \"arguments\": {\"title\": \"Buy groceries\"},\n                \"result\": {\"success\": true, \"task_id\": 42}\n            }\n        ],\n        \"created_at\": \"2026-01-04T10:30:00Z\"\n    }","operationId":"send_chat_message_api__user_id__chat_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/{user_id}/conversations":{"get":{"tags":["Chat"],"summary":"List Conversations","description":"List user's conversations with pagination.\n\nRetrieves all conversations for the authenticated user, ordered by\nmost recently updated first. Supports pagination for large conversation lists.\n\nArgs:\n    user_id: User ID from path (must match authenticated user)\n    limit: Maximum number of conversations to return (default: 20, max: 100)\n    offset: Number of conversations to skip (default: 0)\n    current_user: Authenticated user from JWT token\n    session: Database session\n\nReturns:\n    Dict containing:\n    - conversations: List of ConversationResponse objects\n    - total: Total count of user's conversations\n    - limit: Applied limit\n    - offset: Applied offset\n\nRaises:\n    HTTPException 401: Invalid or missing authentication\n    HTTPException 403: User ID mismatch (not authorized)\n\nExample:\n    GET /api/user123/conversations?limit=10&offset=0\n\n    Response:\n    {\n        \"conversations\": [\n            {\n                \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n                \"created_at\": \"2026-01-05T10:00:00Z\",\n                \"updated_at\": \"2026-01-05T10:30:00Z\"\n            }\n        ],\n        \"total\": 1,\n        \"limit\": 10,\n        \"offset\": 0\n    }","operationId":"list_conversations_api__user_id__conversations_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response List Conversations Api  User Id  Conversations Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/{user_id}/conversations/{conversation_id}":{"get":{"tags":["Chat"],"summary":"Get Conversation History","description":"Get conversation history with all messages.\n\nRetrieves a specific conversation and all its messages in chronological order.\nUseful for loading conversation context in the frontend.\n\nArgs:\n    user_id: User ID from path (must match authenticated user)\n    conversation_id: UUID of the conversation to retrieve\n    current_user: Authenticated user from JWT token\n    session: Database session\n\nReturns:\n    Dict containing:\n    - conversation: ConversationResponse object\n    - messages: List of MessageResponse objects (chronological order)\n\nRaises:\n    HTTPException 401: Invalid or missing authentication\n    HTTPException 403: User ID mismatch or conversation access denied\n    HTTPException 404: Conversation not found\n\nExample:\n    GET /api/user123/conversations/550e8400-e29b-41d4-a716-446655440000\n\n    Response:\n    {\n        \"conversation\": {\n            \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n            \"created_at\": \"2026-01-05T10:00:00Z\",\n            \"updated_at\": \"2026-01-05T10:30:00Z\"\n        },\n        \"messages\": [\n            {\n                \"id\": 1,\n                \"role\": \"user\",\n                \"content\": \"Add a task to buy milk\",\n                \"created_at\": \"2026-01-05T10:00:00Z\"\n            },\n            {\n                \"id\": 2,\n                \"role\": \"assistant\",\n                \"content\": \"I've added 'Buy milk' to your tasks.\",\n                \"created_at\": \"2026-01-05T10:00:05Z\"\n            }\n        ]\n    }","operationId":"get_conversation_history_api__user_id__conversations__conversation_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Conversation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Conversation History Api  User Id  Conversations  Conversation Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Chat"],"summary":"Delete Conversation","description":"Delete a conversation and all its messages.\n\nPermanently removes a conversation and all associated messages from the database.\nThis action cannot be undone. Messages are automatically deleted via CASCADE.\n\nArgs:\n    user_id: User ID from path (must match authenticated user)\n    conversation_id: UUID of the conversation to delete\n    current_user: Authenticated user from JWT token\n    session: Database session\n\nReturns:\n    204 No Content on successful deletion\n\nRaises:\n    HTTPException 401: Invalid or missing authentication\n    HTTPException 403: User ID mismatch or conversation access denied\n    HTTPException 404: Conversation not found\n\nExample:\n    DELETE /api/user123/conversations/550e8400-e29b-41d4-a716-446655440000\n\n    Response: 204 No Content","operationId":"delete_conversation_api__user_id__conversations__conversation_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Conversation Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint\nReturns server status and configuration info\n\nReturns:\n    dict: Health status and application metadata","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint\nReturns API information","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AuthResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"JWT access token"},"refresh_token":{"type":"string","title":"Refresh Token","description":"JWT refresh token"},"token_type":{"type":"string","title":"Token Type","description":"Token type","default":"bearer"},"user":{"type":"object","title":"User","description":"User profile data"}},"type":"object","required":["access_token","refresh_token","user"],"title":"AuthResponse","description":"Authentication response with JWT token.","example":{"access_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","refresh_token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...","token_type":"bearer","user":{"email":"user@example.com","id":"550e8400-e29b-41d4-a716-446655440000","name":"John Doe"}}},"ChatResponse":{"properties":{"conversation_id":{"type":"string","format":"uuid","title":"Conversation Id"},"response":{"type":"string","title":"Response"},"tool_calls":{"items":{"type":"object"},"type":"array","title":"Tool Calls","description":"List of MCP tools invoked by AI agent"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["conversation_id","response","created_at"],"title":"ChatResponse","description":"Schema for chat API response.\n\nReturned by POST /api/{user_id}/chat endpoint.\nContains the AI's response, conversation ID, and any tool calls made."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Registered email"},"password":{"type":"string","title":"Password","description":"User password"},"remember_me":{"type":"boolean","title":"Remember Me","description":"Remember session","default":false}},"type":"object","required":["email","password"],"title":"LoginRequest","description":"User login request.","example":{"email":"user@example.com","password":"SecurePass123!","remember_me":true}},"MessageCreate":{"properties":{"conversation_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Conversation Id","description":"Existing conversation ID (optional, creates new if not provided)"},"message":{"type":"string","maxLength":5000,"minLength":1,"title":"Message","description":"User message text (1-5000 characters)"}},"type":"object","required":["message"],"title":"MessageCreate","description":"Schema for sending a chat message.\n\nUsed for POST /api/{user_id}/chat requests.\nconversation_id is optional - if not provided, a new conversation is created."},"SignupRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Valid email address"},"password":{"type":"string","minLength":8,"title":"Password","description":"Password (min 8 chars)"},"name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Name","description":"Display name"}},"type":"object","required":["email","password"],"title":"SignupRequest","description":"User registration request.","example":{"email":"user@example.com","name":"John Doe","password":"SecurePass123!"}},"TaskCreate":{"properties":{"title":{"type":"string","maxLength":200,"minLength":1,"title":"Title","description":"Task title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Task description"},"due_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Due Date","description":"Task due date"},"priority":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Priority","description":"Priority: low, medium, high","default":"medium"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category","description":"Category: personal, work, study, health, shopping, other","default":"other"}},"type":"object","required":["title"],"title":"TaskCreate","description":"Request schema for creating a new task.","example":{"category":"personal","description":"Milk, eggs, bread","due_date":"2026-01-15","priority":"high","title":"Buy groceries"}},"TaskListResponse":{"properties":{"tasks":{"items":{"$ref":"#/components/schemas/TaskResponse"},"type":"array","title":"Tasks"},"total":{"type":"integer","title":"Total"},"completed":{"type":"integer","title":"Completed"},"pending":{"type":"integer","title":"Pending"}},"type":"object","required":["tasks","total","completed","pending"],"title":"TaskListResponse","description":"Response schema for task list with metadata.","example":{"completed":2,"pending":3,"tasks":[{"category":"personal","completed":false,"created_at":"2025-12-30T10:00:00Z","description":"Milk, eggs, bread","due_date":"2026-01-15","id":1,"priority":"high","status":"pending","title":"Buy groceries","updated_at":"2025-12-30T10:00:00Z","user_id":"550e8400-e29b-41d4-a716-446655440000"}],"total":5}},"TaskResponse":{"properties":{"id":{"type":"integer","title":"Id"},"user_id":{"type":"string","title":"User Id"},"title":{"type":"string","title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"completed":{"type":"boolean","title":"Completed"},"status":{"type":"string","title":"Status"},"due_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Due Date"},"priority":{"type":"string","title":"Priority"},"category":{"type":"string","title":"Category"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","user_id","title","description","completed","status","due_date","priority","category","created_at","updated_at"],"title":"TaskResponse","description":"Response schema for task data.","example":{"category":"personal","completed":false,"created_at":"2025-12-30T10:00:00Z","description":"Milk, eggs, bread","due_date":"2026-01-15","id":1,"priority":"high","status":"pending","title":"Buy groceries","updated_at":"2025-12-30T10:00:00Z","user_id":"550e8400-e29b-41d4-a716-446655440000"}},"TaskUpdate":{"properties":{"title":{"anyOf":[{"type":"string","maxLength":200,"minLength":1},{"type":"null"}],"title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"completed":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Completed"},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status","description":"Status: pending, in_progress, completed"},"due_date":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Due Date","description":"Task due date"},"priority":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Priority","description":"Priority: low, medium, high"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category","description":"Category: personal, work, study, health, shopping, other"}},"type":"object","title":"TaskUpdate","description":"Request schema for updating an existing task.","example":{"category":"personal","completed":false,"description":"Milk, eggs, bread, apples","due_date":"2026-01-20","priority":"medium","status":"in_progress","title":"Buy groceries and fruits"}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}